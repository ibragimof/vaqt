(function(){"use strict";function n(n){return n.valueOf()/S-.5+j}function t(n){return new Date((n+.5-j)*S)}function e(t){return n(t)-k}function r(n,t){return E(P(n)*b(q)-y(t)*P(q),b(n))}function a(n,t){return T(P(t)*b(q)+b(t)*P(q)*P(n))}function u(n,t,e){return E(P(n),b(n)*P(t)-y(e)*b(t))}function o(n,t,e){return T(P(t)*P(e)+b(t)*b(e)*b(n))}function i(n,t){return I*(280.16+360.9856235*n)-t}function c(n){return n<0&&(n=0),2967e-7/Math.tan(n+.00312536/(n+.08901179))}function d(n){return I*(357.5291+.98560028*n)}function s(n){var t=I*(1.9148*P(n)+.02*P(2*n)+3e-4*P(3*n)),e=102.9372*I;return n+t+e+D}function f(n){var t=d(n),e=s(t);return{dec:a(e,0),ra:r(e,0)}}function l(n,t){return Math.round(n-C-t/(2*D))}function h(n,t,e){return C+(n+t)/(2*D)+e}function M(n,t,e){return k+n+.0053*P(t)-.0069*P(2*e)}function g(n,t,e){return H((P(n)-P(t)*P(e))/(b(t)*b(e)))}function v(n){return-2.076*Math.sqrt(n)/60}function m(n,t,e,r,a,u,o){var i=g(n,e,r),c=h(i,t,a);return M(c,u,o)}function w(n){var t=I*(218.316+13.176396*n),e=I*(134.963+13.064993*n),u=I*(93.272+13.22935*n),o=t+6.289*I*P(e),i=5.128*I*P(u),c=385001-20905*b(e);return{ra:r(o,i),dec:a(o,i),dist:c}}function p(n,t){return new Date(n.valueOf()+t*S/24)}var D=Math.PI,P=Math.sin,b=Math.cos,y=Math.tan,T=Math.asin,E=Math.atan2,H=Math.acos,I=D/180,S=864e5,j=2440588,k=2451545,q=23.4397*I,x={getPosition:function(n,t,r){var a=I*-r,c=I*t,d=e(n),s=f(d),l=i(d,a)-s.ra;return{azimuth:u(l,c,s.dec),altitude:o(l,c,s.dec)}}},z=x.times=[[-.833,"sunrise","sunset"],[-.3,"sunriseEnd","sunsetStart"],[-6,"dawn","dusk"],[-12,"nauticalDawn","nauticalDusk"],[-18,"nightEnd","night"],[6,"goldenHourEnd","goldenHour"]];x.addTime=function(n,t,e){z.push([n,t,e])},x.addTime(-17,"fajrStart","maghribEnd");var C=9e-4;x.getTimes=function(n,r,u,o){o=o||0;var i,c,f,g,w,p,D=I*-u,P=I*r,b=v(o),y=e(n),T=l(y,D),E=h(0,D,T),H=d(E),S=s(H),j=a(S,0),k=M(E,H,S),q={solarNoon:t(k),nadir:t(k-.5)};for(i=0,c=z.length;i<c;i+=1)f=z[i],g=(f[0]+b)*I,w=m(g,D,P,j,T,H,S),p=k-(w-k),q[f[1]]=t(p),q[f[2]]=t(w);return q},x.getMoonPosition=function(n,t,r){var a=I*-r,d=I*t,s=e(n),f=w(s),l=i(s,a)-f.ra,h=o(l,d,f.dec),M=E(P(l),y(d)*b(f.dec)-P(f.dec)*b(l));return h+=c(h),{azimuth:u(l,d,f.dec),altitude:h,distance:f.dist,parallacticAngle:M}},x.getMoonIllumination=function(n){var t=e(n||new Date),r=f(t),a=w(t),u=149598e3,o=H(P(r.dec)*P(a.dec)+b(r.dec)*b(a.dec)*b(r.ra-a.ra)),i=E(u*P(o),a.dist-u*b(o)),c=E(b(r.dec)*P(r.ra-a.ra),P(r.dec)*b(a.dec)-b(r.dec)*P(a.dec)*b(r.ra-a.ra));return{fraction:(1+b(i))/2,phase:.5+.5*i*(c<0?-1:1)/Math.PI,angle:c}},x.getMoonTimes=function(n,t,e,r){var a=new Date(n);r?a.setUTCHours(0,0,0,0):a.setHours(0,0,0,0);for(var u,o,i,c,d,s,f,l,h,M,g,v,m,w=.133*I,D=x.getMoonPosition(a,t,e).altitude-w,P=1;P<=24&&(u=x.getMoonPosition(p(a,P),t,e).altitude-w,o=x.getMoonPosition(p(a,P+1),t,e).altitude-w,d=(D+o)/2-u,s=(o-D)/2,f=-s/(2*d),l=(d*f+s)*f+u,h=s*s-4*d*u,M=0,h>=0&&(m=Math.sqrt(h)/(2*Math.abs(d)),g=f-m,v=f+m,Math.abs(g)<=1&&M++,Math.abs(v)<=1&&M++,g<-1&&(g=v)),1===M?D<0?i=P+g:c=P+g:2===M&&(i=P+(l<0?v:g),c=P+(l<0?g:v)),!i||!c);P+=2)D=o;var b={};return i&&(b.rise=p(a,i)),c&&(b.set=p(a,c)),i||c||(b[l>0?"alwaysUp":"alwaysDown"]=!0),b},"object"==typeof exports&&"undefined"!=typeof module?module.exports=x:"function"==typeof define&&define.amd?define(x):window.SunCalc=x})();